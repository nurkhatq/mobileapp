### Техническое задание на разработку бэкенда платформы Jazyl

**Исчерпывающее описание проекта и бизнес-логики**

Платформа Jazyl представляет собой комплексную экосистему для бизнесов в сфере красоты и ухода, предназначенную для цифровой трансформации салонов и частных мастеров. Ключевым отличием от агрегаторов услуг является предоставление каждому бизнесу собственного white-label решения в виде автоматически генерируемого веб-сайта с системой онлайн-записи и полнофункциональной CRM-системой. Это позволяет салонам не просто присутствовать в онлайн-пространстве, а создавать и развивать собственный цифровой бренд.

Целевая аудитория платформы строго ограничена следующими категориями: Парикмахерские услуги включая барбершопы и женские салоны, Ногтевой сервис с маникюром и педикюром, Уход за телом через массажные и СПА-процедуры, Макияж, Удаление волос методами лазерной и восковой эпиляции, Косметология эстетического и аппаратного направления, Тату и пирсинг, услуги по коррекции и ламинированию Бровей, наращиванию и ламинированию Ресниц. Категоризация является фундаментальным принципом работы платформы и влияет на все аспекты взаимодействия — от логики каталога до системы продвижения.

Архитектурно система строится вокруг единого бэкенд-ядра, которое обслуживает несколько клиентских интерфейсов: веб-панель управления для администраторов и менеджеров, кроссплатформенные мобильные приложения для мастеров и клиентов, автоматически генерируемые веб-сайты для каждого салона, а также общедоступный каталог с возможностью фильтрации по категориям. Интеграция с мессенджером WhatsApp реализуется через неофициальную библиотеку WhatsApp Web JS, что требует особого внимания к стабильности работы и механизмам восстановления соединения.

**Детализация пользовательских ролей и системы разрешений**

В системе предусмотрено пять основных типов пользователей с четко разграниченными правами доступа. Администратор Платформы обладает высшими привилегиями и работает через веб-панель на поддомене admin.jazyl.tech. Его компетенции включают управление категориями салонов, активацию и блокировку бизнес-аккаунтов, настройку тарифных планов, модерацию контента в каталоге, управление системой продвижения с разделением по категориям и просмотр агрегированной статистики по всей платформе. Важно отметить, что Администратор Платформы не имеет доступа к внутренним данным салонов — их клиентской базе, финансовым показателям и операционной деятельности.

Администратор Салона или владелец бизнеса проходит регистрацию через OAuth Google и получает доступ к веб-панели управления на поддомене my.jazyl.tech. При создании салона обязательно выбирается одна основная категория из фиксированного списка, что в дальнейшем определяет позиционирование бизнеса в каталоге. Владелец обладает полным контролем над своим аккаунтом: управление профилем салона, создание и редактирование филиалов с индивидуальными графиками работы, формирование прайс-листа услуг, приглашение мастеров через email-приглашения, назначение мастеров к конкретным филиалам, управление расписанием, просмотр аналитики по ключевым бизнес-показателям, дизайн и контент автоматически сгенерированного сайта, контроль участия в каталоге и пополнение рекламного бюджета для продвижения в рамках своей категории.

Менеджер Салона назначается владельцем и работает в той же веб-панели, но с ограниченными правами. Менеджер может управлять расписанием, обрабатывать записи, приглашать мастеров, но не имеет доступа к финансовой аналитике, не может изменять настройки сайта, управлять участием в каталоге или изменять права доступа других сотрудников.

Мастер получает доступ к системе после принятия приглашения от администратора салона и авторизации через OAuth Google. Базовый функционал мастера включает просмотр личного расписания, управление своими записями с возможностью отметки о выполнении услуг. Расширенные права, которые владелец салона может предоставить дополнительно, включают самостоятельное управление личным расписанием с блокировкой слотов и объявлением выходных, редактирование персонального профиля с портфолио и биографией, настройку описания и стоимости закрепленных услуг.

Клиентская роль предусматривает регистрацию по номеру телефона с подтверждением через код в WhatsApp. Клиенты работают primarily через мобильное приложение, где могут просматривать каталог салонов с фильтрацией по категориям, осуществлять запись, управлять своими бронированиями и оставлять отзывы после завершенных визитов.

**Структура поддоменов и организация доступа**

Архитектура платформы реализуется через систему поддоменов основного домена jazyl.tech. Административная панель управления платформой размещается на admin.jazyl.tech. Единый кабинет управления для владельцев салонов, менеджеров и мастеров доступен на my.jazyl.tech с динамическим изменением интерфейса в зависимости от роли пользователя. Публичный каталог всех салонов с возможностью фильтрации по категориям и городам располагается на catalog.jazyl.tech. Каждый салон получает уникальный поддомен вида [название-салона].jazyl.tech, где размещается его автоматически сгенерированный сайт с системой онлайн-записи. API бэкенда доступно через api.jazyl.tech или через выделенный путь основного домена.

**Детализация бизнес-процессов и workflow**

Процесс онлайн-записи реализован через три альтернативных сценария для максимального удобства различных типов клиентов. При выборе записи через мастера клиент сначала выбирает конкретного специалиста, затем видит его доступные временные слоты и после выбора времени выбирает услугу из тех, что предоставляет данный мастер. При записи через услугу клиент сначала выбирает нужную услугу, после чего система показывает мастеров, оказывающих эту услугу, с указанием ближайших доступных слотов для каждого, что позволяет выбрать связку "мастер-время" одним действием. Третий сценарий предполагает первоначальный выбор даты и времени, после чего система отображает всех мастеров, свободных в выбранный слот, с последующим выбором мастера и услуги.

Система филиалов позволяет салонам управлять несколькими локациями. Каждый филиал имеет независимые настройки адреса, контактов и графика работы. Мастера могут быть привязаны к одному или нескольким филиалам. В процессе онлайн-записи, если у салона несколько филиалов, клиенту предлагается выбрать предпочтительную локацию, после чего все дальнейшие действия происходят в контексте выбранного филиала.

Механизм отзывов построен на принципе верификации — оставить отзыв могут только клиенты, которые фактически посетили салон и чья запись была отмечена мастером как выполненная. После завершения визита система автоматически отправляет клиенту в WhatsApp уникальную ссылку для оставления отзыва. Альтернативно, клиент может оставить отзыв через каталог, где система автоматически проверит наличие завершенных визитов в данный салон.

Каталог и система продвижения работают с учетом категорийной принадлежности салонов. При включении в каталог салон участвует в выдаче и аукционе за топ-позиции строго в рамках своей категории. Администратор салона может пополнять рекламный бюджет и устанавливать ставки для участия в аукционе, конкурируя только с салонами из той же категории. В выдаче каталога органические и платные позиции чередуются для обеспечения видимости как крупных, так и начинающих салонов.

**Технические требования и спецификации реализации**

Бэкенд система реализуется на FastAPI с использованием Python, обеспечивая высокую производительность и автоматическую генерацию документации API. В качестве основной базы данных используется PostgreSQL, для кеширования и работы асинхронных задач применяется Redis. Асинхронная обработка задач, таких как отправка уведомлений, реализуется через Celery. Интеграция с WhatsApp осуществляется через неофициальную библиотеку WhatsApp Web JS, что требует реализации механизмов поддержания активной сессии, обработки разрывов соединения и мониторинга статуса интеграции.

Система должна быть полностью готова к промышленной эксплуатации с момента развертывания. Все данные должны быть реальными, без использования мок-данных на любом этапе. Реализуется полная поддержка трех языков: русского, казахского и английского на уровне бэкенда, включая системные сообщения, ошибки валидации и уведомления. Аутентификация для сотрудников салонов реализуется через OAuth Google, для клиентов — через подтверждение номера телефона с кодом в WhatsApp.

Развертывание системы осуществляется с использованием Docker и Docker-compose на производственном сервере. Конфигурация включает все необходимые сервисы: приложение FastAPI, базу данных PostgreSQL, кеш Redis, очередь задач Celery, обратный прокси Nginx. Обязательно предоставление полного набора конфигурационных файлов включая Dockerfile для каждого сервиса, docker-compose.yml для оркестрации, .env.example с примерами переменных окружения и .gitignore для исключения служебных файлов.

После реализации бэкенда все API эндпоинты должны быть доступны по защищенному протоколу HTTPS, система должна быть готова к обработке реальных пользователей с чистой, но полностью функциональной базой данных, содержащей предзаполненные справочники категорий и тарифных планов.